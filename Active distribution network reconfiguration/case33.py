# Copyright (c) 1996-2015 PSERC. All rights reserved.
# Use of this source code is governed by a BSD-style
# license that can be found in the LICENSE file.

"""Power flow data for IEEE 33 bus test case.
"""

from numpy import array

def case33():
    """
	Data from ...
       M. E. Baran and F. F. Wu, "Network reconfiguration in distribution
       systems for loss reduction and load balancing," in IEEE Transactions
       on Power Delivery, vol. 4, no. 2, pp. 1401-1407, Apr 1989.
       doi: 10.1109/61.25627
       URL: https://doi.org/10.1109/61.25627
    """
    ppc = {"version": '2','name':'case33'}

    ##-----  Power Flow Data  -----##
    ## system MVA base
    ppc["baseMVA"] = 10

    ## bus data
    # bus_i type Pd Qd Gs Bs area Vm Va baseKV zone Vmax Vmin
    ppc["bus"] = array([
		[1,	3,	0.0,	0.0,	0,	0,	1,	1,	0,	12.66,	1,	1.0,	1.0],
		[2,	1,	0.1,	0.06,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[3,	1,	0.09,	0.04,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[4,	1,	0.12,	0.08,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[5,	1,	0.06,	0.03,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[6,	1,	0.06,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[7,	1,	0.2,	0.1,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[8,	1,	0.2,	0.1,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[9,	1,	0.06,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[10,	1,	0.06,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[11,	1,	0.045,	0.03,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[12,	1,	0.06,	0.035,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[13,	1,	0.06,	0.035,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[14,	1,	0.12,	0.08,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[15,	1,	0.06,	0.01,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[16,	1,	0.06,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[17,	1,	0.06,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[18,	1,	0.09,	0.04,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[19,	1,	0.09,	0.04,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[20,	1,	0.09,	0.04,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[21,	1,	0.09,	0.04,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[22,	1,	0.09,	0.04,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[23,	1,	0.09,	0.05,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[24,	1,	0.42,	0.2,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[25,	1,	0.42,	0.2,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[26,	1,	0.06,	0.025,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[27,	1,	0.06,	0.025,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[28,	1,	0.06,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[29,	1,	0.12,	0.07,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[30,	1,	0.2,	0.6,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[31,	1,	0.15,	0.07,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[32,	1,	0.21,	0.1,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
		[33,	1,	0.06,	0.04,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
    ])

    ## generator data
    # bus, Pg, Qg, Qmax, Qmin, Vg, mBase, status, Pmax, Pmin, Pc1, Pc2,
    # Qc1min, Qc1max, Qc2min, Qc2max, ramp_agc, ramp_10, ramp_30, ramp_q, apf
    ppc["gen"] = array([
		[1,	0.0,	0.0,	10,	-10,	1,	100,	1,	10,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0]
    ])

    ## branch data
    # fbus, tbus, r, x, b, ra/teA, rateB, rateC, ratio, angle, status, angmin, angmax
    ppc["branch"] = array([
		[1,	2,	0.00575259116172393,	0.00293244885684409,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[2,	3,	0.0307595167324284,	0.0156667639990117,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[3,	4,	0.0228356655660625,	0.0116299673811859,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[4,	5,	0.0237777927519847,	0.0121103898534774,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[5,	6,	0.0510994811437299,	0.0441115179103993,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[6,	7,	0.0116798814042811,	0.0386084968641515,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[7,	8,	0.044386045037423,	0.0146684835371073,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[8,	9,	0.0642643047350938,	0.0461704713630771,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[9,	10,	0.0651378001392601,	0.0461704713630771,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[10,	11,	0.0122663711756499,	0.0040555143764865,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[11,	12,	0.0233597628085623,	0.00772419507398506,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[12,	13,	0.0915922323797259,	0.0720633708437217,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[13,	14,	0.0337917936354629,	0.0444796338307266,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[14,	15,	0.0368739845615927,	0.0328184701851062,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[15,	16,	0.0465635442949519,	0.0340039282336176,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[16,	17,	0.0804239697121708,	0.107377542183589,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[17,	18,	0.0456713311321249,	0.0358133115708193,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[2,	19,	0.0102323747345198,	0.00976443076800212,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[19,	20,	0.0938508419247845,	0.0845668336290739,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[20,	21,	0.025549740571865,	0.0298485858109407,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[21,	22,	0.0442300637152505,	0.0584805173089354,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[3,	23,	0.0281515090257032,	0.0192356166503198,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[23,	24,	0.0560284909243828,	0.0442425422210243,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[24,	25,	0.0559037058666447,	0.0437434019900721,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[6,	26,	0.0126656833604117,	0.00645138748505699,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[26,	27,	0.0177319567045764,	0.00902819892734764,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[27,	28,	0.0660736880722955,	0.0582559042050069,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[28,	29,	0.0501760717164684,	0.0437122057256376,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[29,	30,	0.0316642084010292,	0.0161284687126425,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[30,	31,	0.0607952801299761,	0.0600840053008693,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[31,	32,	0.0193728802138317,	0.0225798561976995,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[32,	33,	0.0212758523443369,	0.0330805188063561,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
		[21,	8,	0.124785057738046,	0.124785057738046,	0,	0,	0,	0,	0,	0,	0,	-360,	360],
		[9,	15,	0.124785057738046,	0.124785057738046,	0,	0,	0,	0,	0,	0,	0,	-360,	360],
		[12,	22,	0.124785057738046,	0.124785057738046,	0,	0,	0,	0,	0,	0,	0,	-360,	360],
		[18,	33,	0.0311962644345116,	0.0311962644345116,	0,	0,	0,	0,	0,	0,	0,	-360,	360],
		[25,	29,	0.0311962644345116,	0.0311962644345116,	0,	0,	0,	0,	0,	0,	0,	-360,	360],
    ])

    ##-----  OPF Data  -----##
    ## generator cost data
    # 1 startup shutdown n x1 y1 ... xn yn
    # 2 startup shutdown n c(n-1) ... c0
    ppc["gencost"] = array([
        [2, 0, 0, 3, 0, 20, 0]
    ])

    return ppc