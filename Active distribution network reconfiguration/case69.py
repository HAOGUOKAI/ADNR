'''   Data from ...
       M. E. Baran and F. F. Wu, "Optimal capacitor placement on radial
       distribution systems," in IEEE Transactions on Power Delivery,
       vol. 4, no. 1, pp. 725-734, Jan. 1989, doi: 10.1109/61.19265.
       https://doi.org/10.1109/61.19265
    
'''

from numpy import array

def case69():
    ppc = {"version": '2','name':'case69'}
    ppc["baseMVA"] = 10
    ## bus data
    # bus_i type Pd Qd Gs Bs area Vm Va baseKV zone Vmax Vmin
    ppc["bus"] = array([
        [1,	3,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1,	1],
        [2,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [3,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [4,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [5,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [6,	1,	0.0026,	0.0022,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [7,	1,	0.0404,	0.03,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [8,	1,	0.075,	0.054,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [9,	1,	0.03,	0.022,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [10,	1,	0.028,	0.019,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [11,	1,	0.145,	0.104,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [12,	1,	0.145,	0.104,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [13,	1,	0.008,	0.0055,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [14,	1,	0.008,	0.0055,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [15,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [16,	1,	0.0455,	0.03,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [17,	1,	0.06,	0.035,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [18,	1,	0.06,	0.035,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [19,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [20,	1,	0.001,	0.0006,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [21,	1,	0.114,	0.081,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [22,	1,	0.0053,	0.0035,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [23,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [24,	1,	0.028,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [25,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [26,	1,	0.014,	0.01,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [27,	1,	0.014,	0.01,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [28,	1,	0.026,	0.0186,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [29,	1,	0.026,	0.0186,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [30,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [31,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [32,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [33,	1,	0.014,	0.01,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [34,	1,	0.0195,	0.014,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [35,	1,	0.006,	0.004,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [36,	1,	0.026,	0.0186,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [37,	1,	0.026,	0.0186,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [38,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [39,	1,	0.024,	0.017,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [40,	1,	0.024,	0.017,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [41,	1,	0.0012,	0.001,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [42,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [43,	1,	0.006,	0.0043,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [44,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [45,	1,	0.0392,	0.0263,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [46,	1,	0.0392,	0.0263,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [47,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [48,	1,	0.079,	0.0564,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [49,	1,	0.3847,	0.2745,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [50,	1,	0.3847,	0.2745,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [51,	1,	0.0405,	0.0283,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [52,	1,	0.0036,	0.0027,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [53,	1,	0.0043,	0.0035,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [54,	1,	0.0264,	0.019,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [55,	1,	0.024,	0.0172,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [56,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [57,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [58,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [59,	1,	0.1,	0.072,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [60,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [61,	1,	1.244,	0.888,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [62,	1,	0.032,	0.023,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [63,	1,	0,	0,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [64,	1,	0.227,	0.162,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [65,	1,	0.059,	0.042,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [66,	1,	0.018,	0.013,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [67,	1,	0.018,	0.013,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [68,	1,	0.028,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
        [69,	1,	0.028,	0.02,	0,	0,	1,	1,	0,	12.66,	1,	1.1,	0.9],
    ])

## generator data
    # bus, Pg, Qg, Qmax, Qmin, Vg, mBase, status, Pmax, Pmin, Pc1, Pc2,
    # Qc1min, Qc1max, Qc2min, Qc2max, ramp_agc, ramp_10, ramp_30, ramp_q, apf
    ppc["gen"] = array([
        [1,	0,	0,	10,	-10,	1,	100,	1,	10,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0,	0]
    ])

## branch data
    # fbus, tbus, r, x, b, ra/teA, rateB, rateC, ratio, angle, status, angmin, angmax
    ppc["branch"] = array([
        [1,	2,	3.11962644345116E-05,	7.48710346428277E-05,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [2,	3,	3.11962644345116E-05,	7.48710346428277E-05,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [3,	4,	9.35887933035347E-05,	0.000224613103928483,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [4,	5,	0.00156605247461248,	0.00183434034874928,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [5,	6,	0.0228356655660625,	0.0116299673811859,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [6,	7,	0.0237715534990978,	0.0121103898534774,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [7,	8,	0.00575259116172393,	0.00293244885684409,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [8,	9,	0.00307595167324284,	0.00156605247461248,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [9,	10,	0.0510994811437299,	0.0168896575648446,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [10,	11,	0.0116798814042811,	0.00386209753699253,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [11,	12,	0.044386045037423,	0.0146684835371073,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [12,	13,	0.0642643047350938,	0.0212134598154679,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [13,	14,	0.0651378001392601,	0.0212134598154679,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [14,	15,	0.0660112955434264,	0.0218124280926105,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [15,	16,	0.0122663711756499,	0.0040555143764865,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [16,	17,	0.0233597628085623,	0.00772419507398506,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [17,	18,	0.000293244885684409,	0.000099828046190437,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [18,	19,	0.020439792457492,	0.0067571108765152,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [19,	20,	0.0131398665798163,	0.0043050844919626,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [20,	21,	0.0213132878616583,	0.00704411650931271,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [21,	22,	0.000873495404166323,	0.000287005632797506,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [22,	23,	0.00992665134306158,	0.00328184701851062,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [23,	24,	0.0216065327473427,	0.00714394455550315,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [24,	25,	0.0467195256171245,	0.0154421508950832,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [25,	26,	0.0192730521676412,	0.00637027719752726,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [26,	27,	0.0108063860001148,	0.00356885265130812,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [3,	28,	0.000274527127023702,	0.00067383931178545,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [28,	29,	0.00399312184761748,	0.00976443076800212,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [29,	30,	0.0248197479840974,	0.00820461754627654,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [30,	31,	0.00437995552660542,	0.00144750666976134,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [31,	32,	0.0218997776330271,	0.00723753334880668,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [32,	33,	0.0523473317211104,	0.0175697361295169,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [33,	34,	0.106566439308291,	0.0352268217994504,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [34,	35,	0.0919665875529401,	0.030403879317875,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [3,	36,	0.000274527127023702,	0.00067383931178545,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [36,	37,	0.00399312184761748,	0.00976443076800212,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [37,	38,	0.00656993328990813,	0.00767428105088984,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [38,	39,	0.0018967328776183,	0.00221493477485032,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [39,	40,	0.000112306551964242,	0.000131024310624949,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [40,	41,	0.0454404787753095,	0.0530898028146518,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [41,	42,	0.0193416839493972,	0.0226048132092471,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [42,	43,	0.00255809368362995,	0.0029823628799393,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [43,	44,	0.000574011265595013,	0.000723753334880668,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [44,	45,	0.00679454639383662,	0.00856649421371687,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [45,	46,	5.61532759821208E-05,	7.48710346428277E-05,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [4,	47,	0.000212134598154679,	0.000524097242499794,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [47,	48,	0.00530960420675387,	0.0129963637634175,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [48,	49,	0.0180813548662429,	0.0442425422210243,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [49,	50,	0.0051286658730337,	0.0125471375555605,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [8,	51,	0.00579002667904534,	0.00295116661550479,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [51,	52,	0.0207080803316288,	0.00711274829106863,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [9,	53,	0.01085630002321,	0.00552797805779545,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [53,	54,	0.0126656833604117,	0.00645138748505699,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [54,	55,	0.0177319567045764,	0.00902819892734764,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [55,	56,	0.0175510183708562,	0.00894084938693101,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [56,	57,	0.0992041209017467,	0.0332988926573976,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [57,	58,	0.0488970248746534,	0.0164092350925531,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [58,	59,	0.0189798072819568,	0.00627668840422372,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [59,	60,	0.0240897553963298,	0.00731240438344951,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [60,	61,	0.0316642084010292,	0.0161284687126425,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [61,	62,	0.00607703231184285,	0.00309466943190355,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [62,	63,	0.00904691668600835,	0.00460456863053391,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [63,	64,	0.0443298917614409,	0.0225798561976995,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [64,	65,	0.0649506225526531,	0.0330805188063561,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [11,	66,	0.0125533768084474,	0.00381218351389731,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [66,	67,	0.000293244885684409,	8.73495404166324E-05,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [12,	68,	0.0461330358457557,	0.0152487340555892,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [68,	69,	0.000293244885684409,	0.000099828046190437,	0,	0,	0,	0,	0,	0,	1,	-360,	360],
        [11,	43,	0.0312,	0.312,	0,	600,	600,	600,	0,	0,	1,	-360,	360],
        [13,	20,	0.0312,	0.312,	0,	600,	600,	600,	0,	0,	1,	-360,	360],
        [15,	46,	0.0624,	0.624,	0,	600,	600,	600,	0,	0,	1,	-360,	360],
        [27,	65,	0.0624,	0.624,	0,	600,	600,	600,	0,	0,	1,	-360,	360],
        [50,	59,	0.1248,	1.2478,	0,	600,	600,	600,	0,	0,	1,	-360,	360],
    ])


    ##-----  OPF Data  -----##
    ## generator cost data
    # 1 startup shutdown n x1 y1 ... xn yn
    # 2 startup shutdown n c(n-1) ... c0
    ppc["gencost"] = array([
        [2, 0, 0, 3, 0, 20, 0]
    ])

    return ppc